<!--
    InSight - Main Window
    Author: Kosta Wadenfalk (MrOlof)
    GitHub: https://github.com/MrOlof
-->
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="InSight"
    Width="1400"
    Height="900"
    MinWidth="1000"
    MinHeight="700"
    WindowStartupLocation="CenterScreen"
    Background="{DynamicResource BackgroundBrush}">

    <Window.Resources>
        <SolidColorBrush x:Key="BackgroundBrush" Color="#F3F3F3"/>
        <SolidColorBrush x:Key="BackgroundSecondaryBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="SurfaceHoverBrush" Color="#F5F5F5"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#0078D4"/>
        <SolidColorBrush x:Key="AccentHoverBrush" Color="#106EBE"/>
        <SolidColorBrush x:Key="AccentDarkBrush" Color="#005A9E"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#1A1A1A"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#605E5C"/>
        <SolidColorBrush x:Key="TextTertiaryBrush" Color="#8A8886"/>
        <SolidColorBrush x:Key="TextDisabledBrush" Color="#A19F9D"/>
        <SolidColorBrush x:Key="TextOnAccentBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#E1E1E1"/>
        <SolidColorBrush x:Key="BorderLightBrush" Color="#EDEBE9"/>
        <SolidColorBrush x:Key="DividerBrush" Color="#EDEBE9"/>
        <SolidColorBrush x:Key="NavBackgroundBrush" Color="#F3F3F3"/>
        <SolidColorBrush x:Key="NavItemHoverBrush" Color="#E5E5E5"/>
        <SolidColorBrush x:Key="NavItemSelectedBrush" Color="#E5F3FF"/>
        <SolidColorBrush x:Key="SuccessBrush" Color="#107C10"/>
        <SolidColorBrush x:Key="WarningBrush" Color="#CA5010"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="#D32F2F"/>
        <SolidColorBrush x:Key="InfoBrush" Color="#0078D4"/>
        <SolidColorBrush x:Key="HeaderBrush" Color="#FFFFFF"/>

        <sys:Double xmlns:sys="clr-namespace:System;assembly=mscorlib" x:Key="FontSizeSmall">11</sys:Double>
        <sys:Double xmlns:sys="clr-namespace:System;assembly=mscorlib" x:Key="FontSizeNormal">13</sys:Double>
        <sys:Double xmlns:sys="clr-namespace:System;assembly=mscorlib" x:Key="FontSizeMedium">15</sys:Double>
        <sys:Double xmlns:sys="clr-namespace:System;assembly=mscorlib" x:Key="FontSizeLarge">18</sys:Double>
        <sys:Double xmlns:sys="clr-namespace:System;assembly=mscorlib" x:Key="FontSizeXLarge">24</sys:Double>
        <sys:Double xmlns:sys="clr-namespace:System;assembly=mscorlib" x:Key="FontSizeHeader">32</sys:Double>

        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextOnAccentBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="{DynamicResource FontSizeNormal}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True"><Setter TargetName="border" Property="Background" Value="{DynamicResource AccentHoverBrush}"/></Trigger>
                            <Trigger Property="IsPressed" Value="True"><Setter TargetName="border" Property="Background" Value="{DynamicResource AccentDarkBrush}"/></Trigger>
                            <Trigger Property="IsEnabled" Value="False"><Setter TargetName="border" Property="Background" Value="{DynamicResource TextDisabledBrush}"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="BorderThickness" Value="1.5"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="{DynamicResource FontSizeNormal}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True"><Setter TargetName="border" Property="Background" Value="{DynamicResource NavItemHoverBrush}"/></Trigger>
                            <Trigger Property="IsEnabled" Value="False"><Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource TextDisabledBrush}"/><Setter Property="Foreground" Value="{DynamicResource TextDisabledBrush}"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="HeaderSignInButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextOnAccentBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="{DynamicResource FontSizeNormal}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True"><Setter TargetName="border" Property="Background" Value="{DynamicResource AccentHoverBrush}"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="UserProfileButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True"><Setter TargetName="border" Property="Background" Value="{DynamicResource NavItemHoverBrush}"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="NavButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="16,12"/>
            <Setter Property="FontSize" Value="{DynamicResource FontSizeNormal}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8" Margin="8,2" Padding="{TemplateBinding Padding}">
                            <Grid>
                                <Grid.ColumnDefinitions><ColumnDefinition Width="32"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                <ContentPresenter Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="{TemplateBinding Tag}" VerticalAlignment="Center" Foreground="{TemplateBinding Foreground}"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True"><Setter TargetName="border" Property="Background" Value="{DynamicResource NavItemHoverBrush}"/></Trigger>
                            <Trigger Property="IsEnabled" Value="False"><Setter Property="Foreground" Value="{DynamicResource TextDisabledBrush}"/><Setter Property="Opacity" Value="0.6"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModernTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="FontSize" Value="{DynamicResource FontSizeNormal}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6">
                            <ScrollViewer x:Name="PART_ContentHost" Padding="{TemplateBinding Padding}" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True"><Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource AccentBrush}"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect"><Setter.Value><DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.08" Color="Black"/></Setter.Value></Setter>
        </Style>

        <Style x:Key="ToggleSwitchStyle" TargetType="CheckBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid><Grid.ColumnDefinitions><ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                            <Border x:Name="track" Width="44" Height="24" CornerRadius="12" Background="{DynamicResource BorderBrush}" Cursor="Hand">
                                <Ellipse x:Name="thumb" Width="18" Height="18" Fill="White" HorizontalAlignment="Left" Margin="3,0,0,0"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True"><Setter TargetName="track" Property="Background" Value="{DynamicResource AccentBrush}"/><Setter TargetName="thumb" Property="HorizontalAlignment" Value="Right"/><Setter TargetName="thumb" Property="Margin" Value="0,0,3,0"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DropdownMenuItemStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True"><Setter TargetName="border" Property="Background" Value="{DynamicResource NavItemHoverBrush}"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions><RowDefinition Height="56"/><RowDefinition Height="*"/></Grid.RowDefinitions>

        <Border Grid.Row="0" Background="{DynamicResource HeaderBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
            <Grid Margin="20,0">
                <Grid.ColumnDefinitions><ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="&#xE770;" FontFamily="Segoe MDL2 Assets" FontSize="24" Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center"/>
                    <TextBlock Text="InSight" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center" Margin="12,0,0,0"/>
                </StackPanel>
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <StackPanel x:Name="SigningInPanel" Orientation="Horizontal" Visibility="Collapsed" Margin="0,0,10,0">
                        <TextBlock Text="&#xE117;" FontFamily="Segoe MDL2 Assets" FontSize="14" Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="Signing in..." Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                    </StackPanel>
                    <Grid x:Name="UserProfileSection" Visibility="Collapsed">
                        <Button x:Name="UserProfileButton" Style="{StaticResource UserProfileButtonStyle}">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="32" Height="32" CornerRadius="16" Background="{DynamicResource AccentBrush}" Margin="0,0,10,0"><TextBlock x:Name="HeaderUserInitials" Text="U" FontSize="12" FontWeight="SemiBold" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                                <StackPanel VerticalAlignment="Center" Margin="0,0,8,0"><TextBlock x:Name="HeaderUserName" Text="User Name" FontSize="{DynamicResource FontSizeNormal}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock x:Name="HeaderUserEmail" Text="user@tenant.onmicrosoft.com" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextTertiaryBrush}"/></StackPanel>
                                <TextBlock Text="&#xE70D;" FontFamily="Segoe MDL2 Assets" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Popup x:Name="UserDropdownPopup" PlacementTarget="{Binding ElementName=UserProfileButton}" Placement="Bottom" StaysOpen="False" AllowsTransparency="True">
                            <Border Background="{DynamicResource SurfaceBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="8" Margin="0,4,0,0" MinWidth="200">
                                <Border.Effect><DropShadowEffect BlurRadius="16" ShadowDepth="4" Opacity="0.15" Color="Black"/></Border.Effect>
                                <StackPanel Margin="4">
                                    <Button x:Name="MenuRefreshToken" Style="{StaticResource DropdownMenuItemStyle}"><StackPanel Orientation="Horizontal"><TextBlock Text="&#xE72C;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" Foreground="{DynamicResource TextSecondaryBrush}"/><TextBlock Text="Refresh Token" Margin="8,0,0,0"/></StackPanel></Button>
                                    <Button x:Name="MenuSettings" Style="{StaticResource DropdownMenuItemStyle}"><StackPanel Orientation="Horizontal"><TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" Foreground="{DynamicResource TextSecondaryBrush}"/><TextBlock Text="Settings" Margin="8,0,0,0"/></StackPanel></Button>
                                    <Border Height="1" Background="{DynamicResource DividerBrush}" Margin="12,4"/>
                                    <Button x:Name="MenuSignOut" Style="{StaticResource DropdownMenuItemStyle}"><StackPanel Orientation="Horizontal"><TextBlock Text="&#xE8BB;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" Foreground="{DynamicResource ErrorBrush}"/><TextBlock Text="Sign Out" Margin="8,0,0,0" Foreground="{DynamicResource ErrorBrush}"/></StackPanel></Button>
                                </StackPanel>
                            </Border>
                        </Popup>
                    </Grid>
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions><ColumnDefinition Width="260" MinWidth="200" MaxWidth="320"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>

            <Border Grid.Column="0" Background="{DynamicResource NavBackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,1,0">
                <Grid>
                    <Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="*"/><RowDefinition Height="Auto"/></Grid.RowDefinitions>
                    <!-- Search box removed -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel x:Name="NavigationPanel" Margin="0,6,0,10">
                            <Button x:Name="NavDashboard" Style="{StaticResource NavButtonStyle}" Tag="Dashboard"><TextBlock Text="&#xE80F;" FontFamily="Segoe MDL2 Assets" FontSize="16"/></Button>
                            <Border Height="1" Background="{DynamicResource DividerBrush}" Margin="20,12"/>
                            <TextBlock Text="TOOLS" FontSize="11" FontWeight="SemiBold" Foreground="{DynamicResource TextTertiaryBrush}" Margin="20,8,20,8"/>
                            <Grid><Button x:Name="NavApps" Style="{StaticResource NavButtonStyle}" Tag="Applications" IsEnabled="False"><TextBlock Text="&#xE71D;" FontFamily="Segoe MDL2 Assets" FontSize="16"/></Button><TextBlock x:Name="NavAppsLock" Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="10" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0"/></Grid>
                            <Grid><Button x:Name="NavConfiguration" Style="{StaticResource NavButtonStyle}" Tag="Configurations" IsEnabled="False"><TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="16"/></Button><TextBlock x:Name="NavConfigurationLock" Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="10" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0"/></Grid>
                            <Grid><Button x:Name="NavAssignments" Style="{StaticResource NavButtonStyle}" Tag="Assignments" IsEnabled="False"><TextBlock Text="&#xE8F4;" FontFamily="Segoe MDL2 Assets" FontSize="16"/></Button><TextBlock x:Name="NavAssignmentsLock" Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="10" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0"/></Grid>
                            <Grid><Button x:Name="NavDeviceOwnership" Style="{StaticResource NavButtonStyle}" Tag="Device Ownership" IsEnabled="False"><TextBlock Text="&#xE770;" FontFamily="Segoe MDL2 Assets" FontSize="16"/></Button><TextBlock x:Name="NavDeviceOwnershipLock" Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="10" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0"/></Grid>
                            <Grid><Button x:Name="NavRemediation" Style="{StaticResource NavButtonStyle}" Tag="Remediation Scripts" IsEnabled="False"><TextBlock Text="&#xE90F;" FontFamily="Segoe MDL2 Assets" FontSize="16"/></Button><TextBlock x:Name="NavRemediationLock" Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="10" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0"/></Grid>
                            <Grid><Button x:Name="NavBackup" Style="{StaticResource NavButtonStyle}" Tag="Backup" IsEnabled="False"><TextBlock Text="&#xE8C8;" FontFamily="Segoe MDL2 Assets" FontSize="16"/></Button><TextBlock x:Name="NavBackupLock" Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="10" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0"/></Grid>
                            <Grid><Button x:Name="NavReports" Style="{StaticResource NavButtonStyle}" Tag="Reports - Coming soon" IsEnabled="False"><TextBlock Text="&#xE9F9;" FontFamily="Segoe MDL2 Assets" FontSize="16"/></Button><TextBlock x:Name="NavReportsLock" Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="10" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0"/></Grid>
                        </StackPanel>
                    </ScrollViewer>
                    <Border Grid.Row="2" BorderBrush="{DynamicResource DividerBrush}" BorderThickness="0,1,0,0" Padding="16,12">
                        <StackPanel>
                            <TextBlock Text="InSight" FontSize="14" FontWeight="SemiBold" Foreground="{DynamicResource AccentBrush}" HorizontalAlignment="Center"/>
                            <TextBlock FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextTertiaryBrush}" HorizontalAlignment="Center" Margin="0,2,0,0" TextAlignment="Center">
                                <Run Text="by "/>
                                <Hyperlink NavigateUri="https://github.com/MrOlof" Foreground="{DynamicResource AccentBrush}">
                                    <Run Text="MrOlof"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Text="v1.0.0" FontSize="10" Foreground="{DynamicResource TextTertiaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <Grid Grid.Column="1">
                <Grid.RowDefinitions><RowDefinition Height="*"/><RowDefinition Height="Auto"/></Grid.RowDefinitions>
                <Grid Grid.Row="0" Background="{DynamicResource BackgroundBrush}">
                    <ScrollViewer x:Name="WelcomeView" Visibility="Visible" VerticalScrollBarVisibility="Auto">
                        <Grid Margin="60,50"><Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="*"/></Grid.RowDefinitions>
                            <StackPanel Grid.Row="0" Margin="0,0,0,50">
                                <TextBlock Text="Welcome to InSight" FontSize="36" FontWeight="Light" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock Text="Sign in with your Microsoft account to access Intune management features" FontSize="{DynamicResource FontSizeMedium}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,12,0,0"/>
                                <Button x:Name="WelcomeSignInButton" Style="{StaticResource ModernButtonStyle}" Margin="0,30,0,0" HorizontalAlignment="Left" Padding="24,14"><StackPanel Orientation="Horizontal"><TextBlock Text="&#xE77B;" FontFamily="Segoe MDL2 Assets" FontSize="16" Margin="0,0,12,0" VerticalAlignment="Center"/><TextBlock Text="Sign in with Microsoft" FontSize="{DynamicResource FontSizeMedium}" VerticalAlignment="Center"/></StackPanel></Button>
                            </StackPanel>
                            <StackPanel Grid.Row="1">
                                <TextBlock Text="Available Features" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,20"/>
                                <Grid><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions><Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="20"/><RowDefinition Height="Auto"/></Grid.RowDefinitions>
                                    <Border Grid.Column="0" Grid.Row="0" Style="{StaticResource CardStyle}" Opacity="0.7"><StackPanel><Grid Margin="0,0,0,12"><TextBlock Text="&#xE71D;" FontFamily="Segoe MDL2 Assets" FontSize="28" Foreground="{DynamicResource AccentBrush}"/><TextBlock Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Top"/></Grid><TextBlock Text="Applications" FontSize="{DynamicResource FontSizeMedium}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="View Intune applications with version checking and export capabilities" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" Margin="0,8,0,0"/></StackPanel></Border>
                                    <Border Grid.Column="2" Grid.Row="0" Style="{StaticResource CardStyle}" Opacity="0.7"><StackPanel><Grid Margin="0,0,0,12"><TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="28" Foreground="{DynamicResource InfoBrush}"/><TextBlock Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Top"/></Grid><TextBlock Text="Configurations" FontSize="{DynamicResource FontSizeMedium}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="View and browse device configuration policies and app protection" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" Margin="0,8,0,0"/></StackPanel></Border>
                                    <Border Grid.Column="4" Grid.Row="0" Style="{StaticResource CardStyle}" Opacity="0.7"><StackPanel><Grid Margin="0,0,0,12"><TextBlock Text="&#xE8F4;" FontFamily="Segoe MDL2 Assets" FontSize="28" Foreground="{DynamicResource SuccessBrush}"/><TextBlock Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Top"/></Grid><TextBlock Text="Assignments" FontSize="{DynamicResource FontSizeMedium}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="Check policy and profile assignments across your tenant" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" Margin="0,8,0,0"/></StackPanel></Border>
                                    <Border Grid.Column="0" Grid.Row="2" Style="{StaticResource CardStyle}" Opacity="0.7"><StackPanel><Grid Margin="0,0,0,12"><TextBlock Text="&#xE770;" FontFamily="Segoe MDL2 Assets" FontSize="28" Foreground="{DynamicResource WarningBrush}"/><TextBlock Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Top"/></Grid><TextBlock Text="Device Ownership" FontSize="{DynamicResource FontSizeMedium}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="Check and verify device ownership status" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" Margin="0,8,0,0"/></StackPanel></Border>
                                    <Border Grid.Column="2" Grid.Row="2" Style="{StaticResource CardStyle}" Opacity="0.7"><StackPanel><Grid Margin="0,0,0,12"><TextBlock Text="&#xE90F;" FontFamily="Segoe MDL2 Assets" FontSize="28" Foreground="{DynamicResource AccentBrush}"/><TextBlock Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Top"/></Grid><TextBlock Text="Remediation Scripts" FontSize="{DynamicResource FontSizeMedium}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="Browse community remediation scripts for deployment to Intune" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" Margin="0,8,0,0"/></StackPanel></Border>
                                    <Border Grid.Column="4" Grid.Row="2" Style="{StaticResource CardStyle}" Opacity="0.7"><StackPanel><Grid Margin="0,0,0,12"><TextBlock Text="&#xE8C8;" FontFamily="Segoe MDL2 Assets" FontSize="28" Foreground="{DynamicResource InfoBrush}"/><TextBlock Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="{DynamicResource TextDisabledBrush}" HorizontalAlignment="Right" VerticalAlignment="Top"/></Grid><TextBlock Text="Backup" FontSize="{DynamicResource FontSizeMedium}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="Create a comprehensive backup of your Intune environment as JSON" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" Margin="0,8,0,0"/></StackPanel></Border>
                                </Grid>
                                <Border Background="{DynamicResource NavItemSelectedBrush}" BorderBrush="{DynamicResource AccentBrush}" BorderThickness="1" CornerRadius="8" Padding="20" Margin="0,30,0,0"><StackPanel Orientation="Horizontal"><TextBlock Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center" Margin="0,0,16,0"/><StackPanel><TextBlock Text="Sign in required" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="Sign in with your Microsoft account to unlock all features and access your Intune environment." FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,4,0,0"/></StackPanel></StackPanel></Border>
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                    <Grid x:Name="DashboardView" Visibility="Collapsed">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <!-- Welcome Icon -->
                            <Border Background="{DynamicResource SurfaceBrush}" CornerRadius="100" Width="140" Height="140" HorizontalAlignment="Center" Margin="0,0,0,40">
                                <TextBlock Text="&#xE909;" FontFamily="Segoe MDL2 Assets" FontSize="64" Foreground="{DynamicResource AccentBrush}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>

                            <!-- Welcome Message -->
                            <TextBlock Text="InSight" FontSize="40" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                            <TextBlock Text="InSights where Intune falls short" FontSize="18" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" TextAlignment="Center" Margin="0,0,0,16"/>
                            <TextBlock Text="Select a tool from the left panel to get started" FontSize="15" Foreground="{DynamicResource TextTertiaryBrush}" HorizontalAlignment="Center" TextAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                    <Grid x:Name="ApplicationsView" Visibility="Collapsed">
                        <Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="*"/></Grid.RowDefinitions>
                        <Border Grid.Row="0" Background="{DynamicResource SurfaceBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1" Padding="30,20">
                            <Grid><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0"><TextBlock Text="Applications" FontSize="{DynamicResource FontSizeHeader}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="View applications | MS Store apps | Version checker" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,8,0,0"/></StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                    <Button x:Name="ExportAppsButton" Style="{StaticResource SecondaryButtonStyle}" Padding="16,10" Margin="0,0,12,0"><StackPanel Orientation="Horizontal"><TextBlock Text="&#xE74E;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,8,0"/><TextBlock Text="Export"/></StackPanel></Button>
                                    <Button x:Name="CheckVersionsButton" Style="{StaticResource SecondaryButtonStyle}" Padding="16,10" Margin="0,0,12,0" IsEnabled="False"><StackPanel Orientation="Horizontal"><TextBlock Text="&#xE895;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,8,0"/><TextBlock Text="Check Versions"/></StackPanel></Button>
                                    <Button x:Name="LoadAppsButton" Style="{StaticResource ModernButtonStyle}" Padding="16,10"><StackPanel Orientation="Horizontal"><TextBlock Text="&#xE896;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,8,0"/><TextBlock Text="Fetch Applications"/></StackPanel></Button>
                                </StackPanel>
                            </Grid>
                        </Border>
                        <Border Grid.Row="1" Background="{DynamicResource BackgroundBrush}" Padding="30,20">
                            <Grid><Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="*"/></Grid.RowDefinitions>

                                <!-- Modern Progress Card -->
                                <Border x:Name="AppsProgressCard" Grid.Row="0" Style="{StaticResource CardStyle}" Visibility="Collapsed" Margin="0,0,0,20">
                                    <StackPanel>
                                        <TextBlock Text="Version Check Progress" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,16"/>
                                        <ProgressBar x:Name="AppsProgressBar" Height="8" Margin="0,0,0,16" Maximum="100" Value="0" Foreground="{DynamicResource AccentBrush}"/>
                                        <TextBlock x:Name="AppsProgressText" Text="Checking versions..." FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Border>

                                <StackPanel x:Name="AppsEmptyState" Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center" Visibility="Visible">
                                    <TextBlock Text="&#xE71D;" FontFamily="Segoe MDL2 Assets" FontSize="64" Foreground="{DynamicResource TextTertiaryBrush}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="No applications loaded" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center" Margin="0,16,0,0"/>
                                    <TextBlock Text="Click 'Fetch Applications' to load applications from Intune" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" TextAlignment="Center" MaxWidth="400" TextWrapping="Wrap" Margin="0,8,0,0"/>
                                </StackPanel>
                                <DataGrid x:Name="AppsDataGrid" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True" GridLinesVisibility="None" HeadersVisibility="Column" SelectionMode="Single" CanUserAddRows="False" CanUserDeleteRows="False" CanUserResizeRows="False" Background="Transparent" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" RowBackground="{DynamicResource SurfaceBrush}" FontSize="{DynamicResource FontSizeNormal}" Visibility="Collapsed" ColumnWidth="*" RowHeight="48">
                                    <DataGrid.Resources>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="{DynamicResource BackgroundBrush}"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="12"/>
                                            <Setter Property="Padding" Value="16,12"/>
                                            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
                                            <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                        </Style>
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="Padding" Value="16,8"/>
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="DataGridCell">
                                                        <Border Background="{TemplateBinding Background}" BorderThickness="0" Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                        <Style TargetType="DataGridRow">
                                            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
                                            <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="{DynamicResource BackgroundBrush}"/>
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1A0078D4"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Display Name" Binding="{Binding displayName}" Width="2*" MinWidth="200"/>
                                        <DataGridTextColumn Header="Publisher" Binding="{Binding publisher}" Width="*" MinWidth="150"/>
                                        <DataGridTextColumn Header="Version" Binding="{Binding version}" Width="100" MinWidth="80"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding appType}" Width="120" MinWidth="100"/>
                                        <DataGridTextColumn Header="Store Alternative" Binding="{Binding storeAlternative}" Width="*" MinWidth="150"/>
                                        <DataGridTextColumn Header="Upgrade Available" Binding="{Binding upgradeAvailable}" Width="140" MinWidth="120"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </Border>
                    </Grid>
                    <ScrollViewer x:Name="ConfigurationsView" Visibility="Collapsed" Padding="30">
                        <StackPanel>
                            <StackPanel Margin="0,0,0,30">
                                <Grid>
                                    <StackPanel>
                                        <TextBlock Text="Configurations" FontSize="{DynamicResource FontSizeHeader}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                        <TextBlock Text="View and manage Intune configuration policies and app protection" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top">
                                        <Button x:Name="AdvancedSearchButton" Content="Advanced Search" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,12,0"/>
                                        <Button x:Name="FetchAllConfigurationsButton" Content="Fetch All" Style="{StaticResource ModernButtonStyle}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,30">
                                <StackPanel>
                                    <Grid Margin="0,0,0,20">
                                        <TextBlock Text="Configuration Profiles" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button x:Name="ExportConfigProfilesButton" Content="Export" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,12,0"/>
                                            <Button x:Name="BenchmarkConfigProfilesButton" Content="Benchmark (Coming Soon)" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,12,0" IsEnabled="False" Opacity="0.5"/>
                                            <Button x:Name="FetchConfigProfilesButton" Content="Fetch Configuration Profiles" Style="{StaticResource ModernButtonStyle}"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBlock Text="Device configuration profiles including settings catalog, restrictions, and templates" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,20"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <Button Grid.Column="0" x:Name="SettingsCatalogButton" Style="{StaticResource SecondaryButtonStyle}" HorizontalAlignment="Stretch" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                <TextBlock Text="Settings Catalog" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="SettingsCatalogCount" Text="0 policies" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Button>
                                        <Button Grid.Column="2" x:Name="DeviceRestrictionsButton" Style="{StaticResource SecondaryButtonStyle}" HorizontalAlignment="Stretch" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                <TextBlock Text="Device Restrictions" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="DeviceRestrictionsCount" Text="0 policies" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Button>
                                        <Button Grid.Column="4" x:Name="AdminTemplatesButton" Style="{StaticResource SecondaryButtonStyle}" HorizontalAlignment="Stretch" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE8B7;" FontFamily="Segoe MDL2 Assets" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                <TextBlock Text="Administrative Templates" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="AdminTemplatesCount" Text="0 policies" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Button>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource CardStyle}">
                                <StackPanel>
                                    <Grid Margin="0,0,0,20">
                                        <TextBlock Text="App Protection" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button x:Name="ExportAppProtectionButton" Content="Export" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,12,0"/>
                                            <Button x:Name="BenchmarkAppProtectionButton" Content="Benchmark (Coming Soon)" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,12,0" IsEnabled="False" Opacity="0.5"/>
                                            <Button x:Name="FetchAppProtectionButton" Content="Fetch App Protection" Style="{StaticResource ModernButtonStyle}"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBlock Text="Mobile application management (MAM) policies for iOS and Android" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,20"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <Button Grid.Column="0" x:Name="AndroidAppProtectionButton" Style="{StaticResource SecondaryButtonStyle}" HorizontalAlignment="Stretch" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE8EA;" FontFamily="Segoe MDL2 Assets" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                <TextBlock Text="Android" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="AndroidAppProtectionCount" Text="0 policies" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Button>
                                        <Button Grid.Column="2" x:Name="iOSAppProtectionButton" Style="{StaticResource SecondaryButtonStyle}" HorizontalAlignment="Stretch" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE8B8;" FontFamily="Segoe MDL2 Assets" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                <TextBlock Text="iOS/iPadOS" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="iOSAppProtectionCount" Text="0 policies" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Button>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                    <ScrollViewer x:Name="AssignmentsView" Visibility="Collapsed" Padding="30">
                        <StackPanel>
                            <StackPanel Margin="0,0,0,30">
                                <TextBlock Text="Assignments" FontSize="{DynamicResource FontSizeHeader}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock Text="Check policy and app assignments for device groups, user groups, and identify orphaned assignments" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                            </StackPanel>

                            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,30">
                                <StackPanel>
                                    <Grid Margin="0,0,0,20">
                                        <TextBlock Text="Device Assignments" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                        <Button x:Name="SearchDeviceGroupsButton" Content="1. Search" Style="{StaticResource ModernButtonStyle}" HorizontalAlignment="Right"/>
                                    </Grid>
                                    <TextBlock x:Name="DeviceSearchInstructions" Text="Select search type, enter name in the box below, then click '1. Search' to find it, then '2. Fetch Assignments' to see results" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,12"/>
                                    <StackPanel Margin="0,0,0,16">
                                        <TextBlock Text="Search Type:" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                                            <RadioButton x:Name="DeviceGroupRadio" Content="Device Group" GroupName="DeviceSearchType" IsChecked="True" Margin="0,0,24,0" FontSize="{DynamicResource FontSizeNormal}"/>
                                            <RadioButton x:Name="SingleDeviceRadio" Content="Single Device" GroupName="DeviceSearchType" FontSize="{DynamicResource FontSizeNormal}"/>
                                        </StackPanel>
                                    </StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                                        <TextBox x:Name="DeviceGroupSearchBox" Grid.Column="0" Style="{StaticResource ModernTextBoxStyle}" Padding="12,10" Foreground="{DynamicResource TextTertiaryBrush}" Text="Enter group display name..."/>
                                        <Button x:Name="FetchDeviceGroupAssignmentsButton" Grid.Column="2" Content="2. Fetch Assignments" Style="{StaticResource SecondaryButtonStyle}" Padding="16,10" IsEnabled="False"/>
                                    </Grid>
                                    <StackPanel x:Name="DeviceGroupResultsPanel" Margin="0,16,0,0"/>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,30">
                                <StackPanel>
                                    <Grid Margin="0,0,0,20">
                                        <TextBlock Text="User Assignments" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                        <Button x:Name="SearchUserGroupsButton" Content="1. Search" Style="{StaticResource ModernButtonStyle}" HorizontalAlignment="Right"/>
                                    </Grid>
                                    <TextBlock x:Name="UserSearchInstructions" Text="Select search type, enter name in the box below, then click '1. Search' to find it, then '2. Fetch Assignments' to see results" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,12"/>
                                    <StackPanel Margin="0,0,0,16">
                                        <TextBlock Text="Search Type:" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                                            <RadioButton x:Name="UserGroupRadio" Content="User Group" GroupName="UserSearchType" IsChecked="True" Margin="0,0,24,0" FontSize="{DynamicResource FontSizeNormal}"/>
                                            <RadioButton x:Name="SingleUserRadio" Content="Single User" GroupName="UserSearchType" FontSize="{DynamicResource FontSizeNormal}"/>
                                        </StackPanel>
                                    </StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                                        <TextBox x:Name="UserGroupSearchBox" Grid.Column="0" Style="{StaticResource ModernTextBoxStyle}" Padding="12,10" Foreground="{DynamicResource TextTertiaryBrush}" Text="Enter group display name..."/>
                                        <Button x:Name="FetchUserGroupAssignmentsButton" Grid.Column="2" Content="2. Fetch Assignments" Style="{StaticResource SecondaryButtonStyle}" Padding="16,10" IsEnabled="False"/>
                                    </Grid>
                                    <StackPanel x:Name="UserGroupResultsPanel" Margin="0,16,0,0"/>
                                </StackPanel>
                            </Border>

                            <Border Style="{StaticResource CardStyle}">
                                <StackPanel>
                                    <Grid Margin="0,0,0,20">
                                        <TextBlock Text="Orphaned Assignments" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                        <Button x:Name="FindOrphanedButton" Content="Find Orphaned" Style="{StaticResource ModernButtonStyle}" HorizontalAlignment="Right"/>
                                    </Grid>
                                    <TextBlock Text="Identify policies and apps with no group assignments or assigned to empty groups" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,20"/>
                                    <TextBlock x:Name="OrphanedLoadingText" Text="Scanning for orphaned assignments..." FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,20" Visibility="Collapsed"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>

                                        <Border Grid.Column="0" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="8" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE7BA;" FontFamily="Segoe MDL2 Assets" FontSize="32" Foreground="{DynamicResource WarningBrush}" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                                <TextBlock Text="No Assignments" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="{DynamicResource FontSizeMedium}"/>
                                                <TextBlock x:Name="NoAssignmentsCount" Text="0 items" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,8"/>
                                                <Button x:Name="ViewNoAssignmentsButton" Content="View Details" Style="{StaticResource SecondaryButtonStyle}" Padding="8,4" FontSize="{DynamicResource FontSizeSmall}" HorizontalAlignment="Center" Visibility="Collapsed"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Grid.Column="2" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="8" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE7E8;" FontFamily="Segoe MDL2 Assets" FontSize="32" Foreground="{DynamicResource ErrorBrush}" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                                <TextBlock Text="Empty Groups" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="{DynamicResource FontSizeMedium}"/>
                                                <TextBlock x:Name="EmptyGroupsCount" Text="0 items" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,8"/>
                                                <Button x:Name="ViewEmptyGroupsButton" Content="View Details" Style="{StaticResource SecondaryButtonStyle}" Padding="8,4" FontSize="{DynamicResource FontSizeSmall}" HorizontalAlignment="Center" Visibility="Collapsed"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Grid.Column="4" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="8" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE946;" FontFamily="Segoe MDL2 Assets" FontSize="32" Foreground="{DynamicResource InfoBrush}" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                                <TextBlock Text="Total Orphaned" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="{DynamicResource FontSizeMedium}"/>
                                                <TextBlock x:Name="TotalOrphanedCount" Text="0 items" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,8"/>
                                                <Button x:Name="ViewAllOrphanedButton" Content="View All" Style="{StaticResource SecondaryButtonStyle}" Padding="8,4" FontSize="{DynamicResource FontSizeSmall}" HorizontalAlignment="Center" Visibility="Collapsed"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                    <Button x:Name="ExportOrphanedButton" Content="Export Results" Style="{StaticResource SecondaryButtonStyle}" HorizontalAlignment="Left" Margin="0,20,0,0" IsEnabled="False"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                    <ScrollViewer x:Name="DeviceOwnershipView" Visibility="Collapsed" Padding="30">
                        <StackPanel>
                            <StackPanel Margin="0,0,0,30">
                                <TextBlock Text="Device Ownership Analysis" FontSize="{DynamicResource FontSizeHeader}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock Text="Select a user group and analyze which members have registered Intune devices, identify users with no devices, and find users with multiple devices" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                            </StackPanel>
                            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,30">
                                <StackPanel>
                                    <Grid Margin="0,0,0,20">
                                        <TextBlock Text="Group Device Analysis" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                        <Button x:Name="SearchOwnershipGroupButton" Content="1. Search Group" Style="{StaticResource ModernButtonStyle}" HorizontalAlignment="Right"/>
                                    </Grid>
                                    <TextBlock Text="Search for a user group to check which members have Intune devices and identify users with multiple devices" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,12"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                                        <TextBox x:Name="OwnershipGroupSearchBox" Grid.Column="0" Style="{StaticResource ModernTextBoxStyle}" Padding="12,10" Foreground="{DynamicResource TextTertiaryBrush}" Text="Enter group display name..."/>
                                        <Button x:Name="AnalyzeOwnershipButton" Grid.Column="2" Content="2. Analyze Devices" Style="{StaticResource SecondaryButtonStyle}" Padding="16,10" IsEnabled="False"/>
                                    </Grid>
                                    <CheckBox x:Name="IncludeNestedGroupsCheckBox" Content="Include nested groups (transitive membership)" Margin="0,12,0,0" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" VerticalContentAlignment="Center">
                                        <CheckBox.ToolTip>
                                            <ToolTip Content="When enabled, analyzes members from nested child groups in addition to direct group members" FontSize="{DynamicResource FontSizeSmall}"/>
                                        </CheckBox.ToolTip>
                                    </CheckBox>
                                    <TextBlock x:Name="OwnershipLoadingText" Text="Analyzing device ownership..." FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,20,0,0" Visibility="Collapsed"/>
                                    <Grid x:Name="OwnershipSummaryCards" Margin="0,20,0,0" Visibility="Collapsed">
                                        <Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/><ColumnDefinition Width="20"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <Border Grid.Column="0" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource WarningBrush}" BorderThickness="2" CornerRadius="8" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE7BA;" FontFamily="Segoe MDL2 Assets" FontSize="32" Foreground="{DynamicResource WarningBrush}" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                                <TextBlock Text="No Devices" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="{DynamicResource FontSizeMedium}"/>
                                                <TextBlock x:Name="NoDevicesCount" Text="0 users" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,8"/>
                                                <Button x:Name="ViewNoDevicesButton" Content="View Details" Style="{StaticResource SecondaryButtonStyle}" Padding="8,4" FontSize="{DynamicResource FontSizeSmall}" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Grid.Column="2" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource InfoBrush}" BorderThickness="2" CornerRadius="8" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE8B7;" FontFamily="Segoe MDL2 Assets" FontSize="32" Foreground="{DynamicResource InfoBrush}" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                                <TextBlock Text="Multiple Devices" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="{DynamicResource FontSizeMedium}"/>
                                                <TextBlock x:Name="MultipleDevicesCount" Text="0 users" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,8"/>
                                                <Button x:Name="ViewMultipleDevicesButton" Content="View Details" Style="{StaticResource SecondaryButtonStyle}" Padding="8,4" FontSize="{DynamicResource FontSizeSmall}" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Grid.Column="4" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource SuccessBrush}" BorderThickness="2" CornerRadius="8" Padding="16,12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE8EA;" FontFamily="Segoe MDL2 Assets" FontSize="32" Foreground="{DynamicResource SuccessBrush}" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                                <TextBlock Text="Single Device" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="{DynamicResource FontSizeMedium}"/>
                                                <TextBlock x:Name="SingleDeviceCount" Text="0 users" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,8"/>
                                                <Button x:Name="ViewSingleDeviceButton" Content="View Details" Style="{StaticResource SecondaryButtonStyle}" Padding="8,4" FontSize="{DynamicResource FontSizeSmall}" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                    <Button x:Name="ExportOwnershipButton" Content="Export Results to CSV" Style="{StaticResource SecondaryButtonStyle}" HorizontalAlignment="Left" Margin="0,20,0,0" Visibility="Collapsed"/>
                                </StackPanel>
                            </Border>
                            <StackPanel x:Name="OwnershipResultsPanel" Visibility="Collapsed"/>
                        </StackPanel>
                    </ScrollViewer>
                    <ScrollViewer x:Name="PlaceholderView" Visibility="Collapsed" Padding="30">
                        <StackPanel MaxWidth="900">
                            <!-- Hidden icon for compatibility (not displayed) -->
                            <TextBlock x:Name="PlaceholderIcon" Visibility="Collapsed"/>

                            <!-- Header -->
                            <Grid Margin="0,0,0,30">
                                <StackPanel>
                                    <TextBlock x:Name="PlaceholderTitle" Text="Reports" FontSize="{DynamicResource FontSizeHeader}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    <TextBlock x:Name="PlaceholderDescription" Text="Generate comprehensive HTML reports for your Microsoft 365 environment" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                                </StackPanel>
                            </Grid>

                            <!-- Coming Soon Banner -->
                            <Border Background="{DynamicResource NavItemSelectedBrush}" BorderBrush="{DynamicResource AccentBrush}" BorderThickness="1.5" CornerRadius="8" Padding="24" Margin="0,0,0,40">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="&#xE946;" FontFamily="Segoe MDL2 Assets" FontSize="32" Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center" Margin="0,0,20,0"/>
                                    <StackPanel>
                                        <TextBlock Text="Feature Coming Soon" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                        <TextBlock Text="The reporting engine is currently in development and will be available in a future update." FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,6,0,0"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- Planned Report Types -->
                            <TextBlock Text="Planned Report Types" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,20"/>

                            <Border Style="{StaticResource CardStyle}" Padding="30">
                                <StackPanel>
                                    <!-- Report Item -->
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="&#xE73E;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center" Margin="0,0,16,0"/>
                                        <TextBlock Grid.Column="1" Text="Conditional Access Overview" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                                    </Grid>

                                    <!-- Report Item -->
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="&#xE73E;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center" Margin="0,0,16,0"/>
                                        <TextBlock Grid.Column="1" Text="Inactive User Reports" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                                    </Grid>

                                    <!-- Report Item -->
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="&#xE73E;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center" Margin="0,0,16,0"/>
                                        <TextBlock Grid.Column="1" Text="Tenant Health Report" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                                    </Grid>

                                    <!-- Report Item -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="&#xE73E;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center" Margin="0,0,16,0"/>
                                        <TextBlock Grid.Column="1" Text="Security Baseline Report" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Permission Warning (Hidden by Default) -->
                            <TextBlock x:Name="PlaceholderPermission" Visibility="Collapsed" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource WarningBrush}" TextAlignment="Center" Margin="0,20,0,0"/>
                        </StackPanel>
                    </ScrollViewer>
                    <ScrollViewer x:Name="SettingsView" Visibility="Collapsed" Padding="30">
                        <StackPanel MaxWidth="700">
                            <TextBlock Text="Settings" FontSize="{DynamicResource FontSizeHeader}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,30"/>
                            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,20"><StackPanel><TextBlock Text="Appearance" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,20"/><Grid><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions><StackPanel><TextBlock Text="Enable Animations" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="Show smooth transitions and effects" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,4,0,0"/></StackPanel><CheckBox x:Name="AnimationsToggle" Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" VerticalAlignment="Center" IsChecked="True"/></Grid></StackPanel></Border>
                            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,20"><StackPanel><TextBlock Text="Data" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,20"/><Grid Margin="0,0,0,16"><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions><StackPanel><TextBlock Text="Enable Caching" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock Text="Cache API responses for faster navigation" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,4,0,0"/></StackPanel><CheckBox x:Name="CachingToggle" Grid.Column="1" Style="{StaticResource ToggleSwitchStyle}" VerticalAlignment="Center" IsChecked="True"/></Grid><StackPanel Margin="0,0,0,16"><TextBlock Text="Export Path" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/><Grid><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions><TextBox x:Name="ExportPathTextBox" Style="{StaticResource ModernTextBoxStyle}" Text="Desktop" IsReadOnly="True"/><Button x:Name="BrowseExportPath" Grid.Column="1" Content="Browse" Style="{StaticResource SecondaryButtonStyle}" Margin="10,0,0,0"/></Grid></StackPanel></StackPanel></Border>
                            <Border Style="{StaticResource CardStyle}"><StackPanel><TextBlock Text="About" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,20"/><TextBlock Text="InSight v1.0.0" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}"/><TextBlock FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,4,0,16"><Run Text="Created by MrOlof "/><Hyperlink NavigateUri="https://github.com/MrOlof"><Run Text="@github"/></Hyperlink></TextBlock><Button x:Name="ViewLogsButton" Content="View Logs" Style="{StaticResource SecondaryButtonStyle}" HorizontalAlignment="Left"/></StackPanel></Border>
                        </StackPanel>
                    </ScrollViewer>
                    <ScrollViewer x:Name="RemediationScriptsView" Visibility="Collapsed" Padding="30">
                        <StackPanel>
                            <StackPanel Margin="0,0,0,30">
                                <TextBlock Text="Remediation Scripts" FontSize="{DynamicResource FontSizeHeader}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock Text="Browse and deploy community remediation scripts for common IT management tasks" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                            </StackPanel>
                            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,30">
                                <StackPanel>
                                    <TextBlock Text="Search Scripts" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,16"/>
                                    <TextBox x:Name="RemediationSearchBox" Style="{StaticResource ModernTextBoxStyle}" Padding="12,10" Margin="0,0,0,16" Text="Search by name, category, or tag..."/>
                                    <TextBlock Text="Filter by Category:" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                    <WrapPanel x:Name="RemediationCategoryFilter" Margin="0,0,0,0">
                                        <Button x:Name="CategoryAll" Content="All" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,8" Padding="12,6" FontSize="{DynamicResource FontSizeSmall}" Tag="All"/>
                                        <Button x:Name="CategorySecurity" Content="Security" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,8" Padding="12,6" FontSize="{DynamicResource FontSizeSmall}" Tag="Security"/>
                                        <Button x:Name="CategoryMaintenance" Content="Maintenance" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,8" Padding="12,6" FontSize="{DynamicResource FontSizeSmall}" Tag="Maintenance"/>
                                        <Button x:Name="CategoryApplicationManagement" Content="Application Management" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,8" Padding="12,6" FontSize="{DynamicResource FontSizeSmall}" Tag="Application Management"/>
                                        <Button x:Name="CategorySystemConfiguration" Content="System Configuration" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,8" Padding="12,6" FontSize="{DynamicResource FontSizeSmall}" Tag="System Configuration"/>
                                        <Button x:Name="CategoryNetwork" Content="Network" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,8" Padding="12,6" FontSize="{DynamicResource FontSizeSmall}" Tag="Network"/>
                                        <Button x:Name="CategoryUserExperience" Content="User Experience" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,8" Padding="12,6" FontSize="{DynamicResource FontSizeSmall}" Tag="User Experience"/>
                                        <Button x:Name="CategoryTroubleshooting" Content="Troubleshooting" Style="{StaticResource SecondaryButtonStyle}" Margin="0,0,8,8" Padding="12,6" FontSize="{DynamicResource FontSizeSmall}" Tag="Troubleshooting"/>
                                    </WrapPanel>
                                </StackPanel>
                            </Border>
                            <StackPanel x:Name="RemediationResultsSummary" Margin="0,0,0,16" Visibility="Collapsed">
                                <TextBlock x:Name="RemediationResultsCount" Text="Showing 89 scripts" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <StackPanel x:Name="RemediationScriptsContainer"/>
                            <Border x:Name="RemediationNoResults" Style="{StaticResource CardStyle}" Padding="40" Visibility="Collapsed">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="&#xE11A;" FontFamily="Segoe MDL2 Assets" FontSize="48" HorizontalAlignment="Center" Foreground="{DynamicResource TextTertiaryBrush}" Margin="0,0,0,16"/>
                                    <TextBlock Text="No scripts found" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                    <TextBlock Text="Try adjusting your search or filter criteria" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                    <ScrollViewer x:Name="BackupView" Visibility="Collapsed" Padding="30">
                        <StackPanel>
                            <!-- Header -->
                            <StackPanel Margin="0,0,0,30">
                                <TextBlock Text="Backup" FontSize="{DynamicResource FontSizeHeader}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock Text="Create a comprehensive backup of your Intune environment" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,8,0,0"/>

                                <!-- Full Backup Option -->
                                <StackPanel Margin="0,16,0,8">
                                    <CheckBox x:Name="BackupSelectAllCheckBox" Content="Full Backup" FontSize="{DynamicResource FontSizeNormal}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" IsChecked="True"/>
                                </StackPanel>

                                <!-- What gets backed up -->
                                <Grid Margin="0,8,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Row 1 -->
                                    <CheckBox x:Name="BackupComplianceCheckBox" Grid.Row="0" Grid.Column="0" Content="Compliance Policies" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,20,8" IsChecked="True"/>
                                    <CheckBox x:Name="BackupConfigurationsCheckBox" Grid.Row="0" Grid.Column="1" Content="Device Configurations" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,20,8" IsChecked="True"/>
                                    <CheckBox x:Name="BackupSettingsCatalogCheckBox" Grid.Row="0" Grid.Column="2" Content="Settings Catalog" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,8" IsChecked="True"/>

                                    <!-- Row 2 -->
                                    <CheckBox x:Name="BackupScriptsCheckBox" Grid.Row="1" Grid.Column="0" Content="PowerShell Scripts" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,20,8" IsChecked="True"/>
                                    <CheckBox x:Name="BackupRemediationsCheckBox" Grid.Row="1" Grid.Column="1" Content="Proactive Remediations" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,20,8" IsChecked="True"/>
                                    <CheckBox x:Name="BackupApplicationsCheckBox" Grid.Row="1" Grid.Column="2" Content="Applications" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,8" IsChecked="True"/>

                                    <!-- Row 3 -->
                                    <CheckBox x:Name="BackupAutopilotCheckBox" Grid.Row="2" Grid.Column="0" Content="Autopilot Profiles" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,20,0" IsChecked="True"/>
                                    <CheckBox x:Name="BackupEndpointSecurityCheckBox" Grid.Row="2" Grid.Column="1" Content="Endpoint Security" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,20,0" IsChecked="True"/>
                                    <CheckBox x:Name="BackupAdminTemplatesCheckBox" Grid.Row="2" Grid.Column="2" Content="Admin Templates" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" IsChecked="True"/>
                                </Grid>
                            </StackPanel>

                            <!-- Backup Configuration Card -->
                            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,30">
                                <StackPanel>
                                    <TextBlock Text="Backup Settings" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,20"/>

                                    <!-- Path Selection -->
                                    <TextBlock Text="Backup Location" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                                    <Grid Margin="0,0,0,20">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="12"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="BackupPathTextBox" Grid.Column="0" Style="{StaticResource ModernTextBoxStyle}" Padding="12,10" Text="Select a folder..." IsReadOnly="True"/>
                                        <Button x:Name="BrowseBackupPathButton" Grid.Column="2" Content="Browse..." Style="{StaticResource SecondaryButtonStyle}" Padding="16,10"/>
                                    </Grid>

                                    <!-- Options -->
                                    <TextBlock Text="Backup Options" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,12"/>
                                    <CheckBox x:Name="IncludeAssignmentsCheckBox" Content="Include policy and profile assignments" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,8" IsChecked="True"/>
                                    <CheckBox x:Name="ExcludeBuiltInCheckBox" Content="Exclude built-in policies and profiles" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,20"/>

                                    <!-- API Version -->
                                    <TextBlock Text="Graph API Version" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,12"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                        <RadioButton x:Name="ApiVersionV1RadioButton" Content="v1.0 (Limited)" GroupName="ApiVersion" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,20,0"/>
                                        <RadioButton x:Name="ApiVersionBetaRadioButton" Content="Beta (Recommended)" GroupName="ApiVersion" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextPrimaryBrush}" IsChecked="True"/>
                                    </StackPanel>

                                    <!-- Start Backup Button -->
                                    <Button x:Name="StartBackupButton" Content="Start Backup" Style="{StaticResource ModernButtonStyle}" Padding="20,12" HorizontalAlignment="Left" IsEnabled="False"/>

                                    <!-- Loading Status Text -->
                                    <TextBlock x:Name="BackupLoadingText" Text="Backup is loading, please wait..." FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource WarningBrush}" FontStyle="Italic" Margin="0,12,0,0" Visibility="Collapsed"/>
                                </StackPanel>
                            </Border>

                            <!-- Progress Section -->
                            <Border x:Name="BackupProgressCard" Style="{StaticResource CardStyle}" Visibility="Collapsed">
                                <StackPanel>
                                    <TextBlock Text="Backup Progress" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,20"/>

                                    <!-- Progress Bar -->
                                    <ProgressBar x:Name="BackupProgressBar" Height="8" Margin="0,0,0,16" IsIndeterminate="True" Foreground="{DynamicResource AccentBrush}"/>

                                    <!-- Status Text -->
                                    <TextBlock x:Name="BackupStatusText" Text="Initializing backup..." FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,12"/>

                                    <!-- Current Item -->
                                    <TextBlock x:Name="BackupCurrentItemText" Text="" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextTertiaryBrush}" FontStyle="Italic"/>
                                </StackPanel>
                            </Border>

                            <!-- Results Section -->
                            <Border x:Name="BackupResultsCard" Style="{StaticResource CardStyle}" Visibility="Collapsed" Margin="0,30,0,0">
                                <StackPanel>
                                    <Grid Margin="0,0,0,20">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock x:Name="BackupResultIcon" Text="&#xE73E;" FontFamily="Segoe MDL2 Assets" FontSize="24" Foreground="{DynamicResource SuccessBrush}" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                            <TextBlock x:Name="BackupResultTitle" Text="Backup Complete" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>

                                    <TextBlock x:Name="BackupResultMessage" Text="" FontSize="{DynamicResource FontSizeNormal}" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" Margin="0,0,0,12"/>

                                    <!-- Stats Grid -->
                                    <Grid x:Name="BackupStatsGrid" Margin="0,12,0,16" Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Border Grid.Column="0" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="6" Padding="12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE8FD;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="{DynamicResource InfoBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                <TextBlock x:Name="BackupItemsCount" Text="0" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" HorizontalAlignment="Center" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                <TextBlock Text="Items Backed Up" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Grid.Column="2" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="6" Padding="12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE838;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="{DynamicResource SuccessBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                <TextBlock x:Name="BackupFilesCount" Text="0" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" HorizontalAlignment="Center" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                <TextBlock Text="Files Created" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Grid.Column="4" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="6" Padding="12">
                                            <StackPanel>
                                                <TextBlock Text="&#xE823;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="{DynamicResource AccentBrush}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                <TextBlock x:Name="BackupDuration" Text="0s" FontSize="{DynamicResource FontSizeLarge}" FontWeight="SemiBold" HorizontalAlignment="Center" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                <TextBlock Text="Duration" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>

                                    <!-- Action Buttons -->
                                    <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                                        <Button x:Name="OpenBackupFolderButton" Content="Open Backup Folder" Style="{StaticResource SecondaryButtonStyle}" Padding="16,10" Margin="0,0,12,0" Visibility="Collapsed"/>
                                        <Button x:Name="NewBackupButton" Content="Create New Backup" Style="{StaticResource ModernButtonStyle}" Padding="16,10"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                        </StackPanel>
                    </ScrollViewer>
                </Grid>
                <Border Grid.Row="1" Background="{DynamicResource BackgroundSecondaryBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0" Padding="16,8"><Grid><Grid.ColumnDefinitions><ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions><StackPanel Grid.Column="0" Orientation="Horizontal"><Ellipse x:Name="ConnectionIndicator" Width="8" Height="8" Fill="{DynamicResource TextDisabledBrush}" Margin="0,0,8,0"/><TextBlock x:Name="ConnectionStatusText" Text="Not signed in" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}"/></StackPanel><TextBlock x:Name="StatusMessageText" Grid.Column="1" Text="" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/><TextBlock x:Name="LastRefreshText" Grid.Column="2" Text="" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextTertiaryBrush}" Margin="0,0,20,0"/><TextBlock x:Name="CurrentTimeText" Grid.Column="3" Text="00:00:00" FontSize="{DynamicResource FontSizeSmall}" Foreground="{DynamicResource TextTertiaryBrush}"/></Grid></Border>
            </Grid>
        </Grid>
    </Grid>
</Window>
